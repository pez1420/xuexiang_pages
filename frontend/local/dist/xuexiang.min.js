var xxModule = angular.module('xxApp', ['ngAnimate']);

xxModule.run(function ($rootScope) {
	$rootScope.userLogin = false;
});
xxModule.animation('.view-slide-in', function () {
  return {
    enter: function(element, done) {
      $(element).slideDown(500);
  	}
  };
});

angular.module('xxApp').run(['$templateCache', function($templateCache) {
  'use strict';

  $templateCache.put('partials/components/footer-panel.html',
    "<footer>\n" +
    "\t<div class=\"container\">\n" +
    "\t\t<div class=\"row\">\n" +
    "\t\t\t<div class=\"col-sm-6\">\n" +
    "\t\t\t\t<span><a>关于我们</a></span>\n" +
    "\t\t\t\t<span><a>留学派</a></span>\n" +
    "\t\t\t\t<span><a>加入我们</a></span>\n" +
    "\t\t\t\t<span><a>联系我们</a></span>\n" +
    "\t\t\t</div>\n" +
    "\t\t\t<div class=\"col-sm-6 pull-right\">浙江省杭州市西湖区教工路26号世贸丽晶城欧美中心B座18楼</div>\n" +
    "\t\t</div>\n" +
    "\t</div>\n" +
    "</footer>"
  );


  $templateCache.put('partials/components/head-bar.html',
    "<header class=\"navbar navbar-static-top bs-docs-nav\" id=\"top\" role=\"banner\">\n" +
    "\t<div class=\"container\">\n" +
    "\t    <div class=\"navbar-header\">\n" +
    "\t      <button class=\"navbar-toggle collapsed\" type=\"button\" data-toggle=\"collapse\" data-target=\"#bs-navbar\" aria-controls=\"bs-navbar\" aria-expanded=\"false\">\n" +
    "\t        <span class=\"sr-only\">Toggle navigation</span>\n" +
    "\t        <span class=\"icon-bar\"></span>\n" +
    "\t        <span class=\"icon-bar\"></span>\n" +
    "\t        <span class=\"icon-bar\"></span>\n" +
    "\t      </button>\n" +
    "\t      <a class=\"navbar-brand\">留学后</a>\n" +
    "\t    </div>\n" +
    "\t    <nav id=\"bs-navbar\" class=\"navbar-collapse collapse\" aria-expanded=\"false\" style=\"height: 1px;\">\n" +
    "\t\t\t<ul class=\"nav navbar-nav\">\n" +
    "\t\t\t\t<li>\n" +
    "\t\t\t\t  <a href=\"../note/index.html\">笔记</a>\n" +
    "\t\t\t\t</li>\n" +
    "\t\t\t\t<li>\n" +
    "\t\t\t\t  <a>导师</a>\n" +
    "\t\t\t\t</li>\n" +
    "\t\t\t\t<li><a>成为导师</a></li>\n" +
    "\t\t\t</ul>\n" +
    "    \t\t<div class=\"headToolKit nav\">\n" +
    "\t\t        <li class=\"avatar\" ng-if=\"!$root.userLogin\">\n" +
    "\t\t        \t<a data-toggle=\"modal\" data-target=\"#loginModal\">\n" +
    "\t\t        \t\t登陆｜注册\n" +
    "\t\t        \t</a>\n" +
    "\t        \t</li>\n" +
    "\t\t        <li class=\"avatar\" ng-if=\"$root.userLogin\">\n" +
    "\t\t        \t<a href=\"../user/index.html\">\n" +
    "\t\t        \t\t<i class=\"glyphicon glyphicon-user\"></i> Jack\n" +
    "\t\t        \t</a>\n" +
    "\t        \t</li>\n" +
    "\t\t    </div>\n" +
    "\t    </nav>\n" +
    "  \t</div>\n" +
    "</header>\n" +
    "<div class=\"modal fade\" id=\"loginModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"loginModalLabel\">\n" +
    "\t<div class=\"modal-dialog\" role=\"document\">\n" +
    "\t    <div class=\"modal-content\">\n" +
    "\t      <div class=\"modal-header clearfix\">\n" +
    "\t        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n" +
    "\t        <ul class=\"nav navbar-nav\">\n" +
    "\t\t\t\t<li class=\"active\">\n" +
    "\t\t\t\t\t<a href=\"#register\" data-toggle=\"tab\">注册</a>\n" +
    "\t\t\t\t</li>\n" +
    "\t\t\t\t<li>\n" +
    "\t\t\t\t\t<a href=\"#login\" data-toggle=\"tab\">登陆</a>\n" +
    "\t\t\t\t</li>\n" +
    "\t        </ul>\n" +
    "\t      </div>\n" +
    "\t      <div class=\"modal-body\">\n" +
    "\t      \t<div class=\"tab-content\">\n" +
    "\t\t\t  <div class=\"tab-pane fade in active\" id=\"register\">\n" +
    "\t\t\t  \t<form name=\"registerForm\" ng-submit=\"register()\">\n" +
    "\t\t\t  \t\t<div class=\"form-group\">\n" +
    "\t\t\t  \t\t\t<label for=\"registerEmail\">邮箱</label>\n" +
    "\t\t\t  \t\t\t<input ng-model=\"model.register.email\" type=\"email\" id=\"registerEmail\" class=\"form-control\" placeholder=\"邮箱\" required/>\n" +
    "\t\t\t  \t\t</div>\n" +
    "\t\t\t  \t\t<div class=\"form-group\">\n" +
    "\t\t\t  \t\t\t<label for=\"registerPassword\">密码</label>\n" +
    "\t\t\t\t\t\t<input ng-model=\"model.register.password\" type=\"password\" id=\"registerPassword\" class=\"form-control\" placeholder=\"密码\" required/>\n" +
    "\t\t\t\t\t</div>\n" +
    "\t\t\t  \t\t<div class=\"form-group\">\n" +
    "\t\t\t  \t\t\t<label for=\"registerPasswordConfirm\">确认密码</label>\n" +
    "\t\t\t\t\t\t<input ng-model=\"model.register.passwordConfirm\" type=\"password\" id=\"registerPasswordConfirm\" class=\"form-control\" placeholder=\"密码\" required/>\n" +
    "\t\t\t\t\t</div>\n" +
    "\t\t\t\t\t<button type=\"submit\" class=\"btn btn-default\" ng-disabled=\"registerForm.$invalid\">注册</button>\n" +
    "\t\t\t  \t</form>\n" +
    "\t\t\t  </div>\n" +
    "\t\t\t  <div class=\"tab-pane fade\" id=\"login\">\n" +
    "\t\t\t  \t<form name=\"loginForm\" ng-submit=\"login()\">\n" +
    "\t\t\t  \t\t<div class=\"form-group\">\n" +
    "\t\t\t  \t\t\t<input ng-model=\"model.login.email\" type=\"email\" class=\"form-control\" placeholder=\"邮箱\" required/>\n" +
    "\t\t\t  \t\t</div>\n" +
    "\t\t\t  \t\t<div class=\"form-group\">\n" +
    "\t\t\t\t\t\t<input ng-model=\"model.login.password\" type=\"password\" class=\"form-control\" placeholder=\"密码\" required/>\n" +
    "\t\t\t\t\t</div>\n" +
    "\t\t\t\t\t<button type=\"submit\" class=\"btn btn-default\" ng-disabled=\"loginForm.$invalid\">登陆</button>\n" +
    "\t\t\t  \t</form>\n" +
    "\t\t\t  </div>\n" +
    "\t\t\t</div>\n" +
    "\t      </div>\n" +
    "\t    </div>\n" +
    "  \t</div>\n" +
    "</div>"
  );

}]);

xxModule.directive('footerPanel', function () {
	return {
		templateUrl: 'partials/components/footer-panel.html'	
	}
});
xxModule.directive('headBar', ['$rootScope', function ($rootScope) {
	return {
		templateUrl: 'partials/components/head-bar.html',
		link: function (scope, element, attrs) {
			scope.model = {
				register: {
					email: '',
					password: '',
					passwordConfirm: ''
				},
				login: {
					email: '',
					password: ''
				}
			};
			scope.register = function () {

			};
			scope.login = function () {
				$rootScope.userLogin = true;
				$('#loginModal').modal('hide');
			};
		}
	}
}]);
'use strict';
function noteController($scope, noteService) {
	var vm = this;
	vm.model = noteService.model;
	vm.onClassificationHover = function (subject) {
		subject.onHover = true;
	};
	vm.onClassificationLeave = function (subject) {
		subject.onHover = false;
	};
	vm.resetClassification = function () {
		vm.model.classifications.forEach(function (item, index) {
			item.onHover = false;
		});
	};
	vm.toggleSubjectMenu = function () {
		vm.model.subjectMenuCollapsed = !vm.model.subjectMenuCollapsed;
	};
	vm.onSearch = function ($event) {
		var keycode = window.event?$event.keyCode:$event.which;
        if (keycode === 13) {
            vm.search(vm.model.searchOptions.searchBy, vm.model.searchOptions.searchKey);
        }
	};
	vm.search = function (searchBy, searchKey) {
		if (searchKey.trim() === '') {
			searchKey = '';
			return;
		} else {
			$('.search-input input').blur();
			vm.model.searchOptions.searchComplete = true;
			console.log('Search by ' + searchBy + ' with ' + searchKey);
		}
	};
}

xxModule.controller('noteController', ['$scope', 'noteService', noteController]);
'use strict';
function noteService() {
	var that = {};
	that.model = {
		searchOptions: {
			searchKey: '',
			searchBy: 0,
			searchComplete: false,
			searchByList: [{
				id: 0,
				name: '标题'
			}, {
				id: 1,
				name: '用户'
			}, {
				id: 2,
				name: '学校'
			}]
		},
		subjectMenuCollapsed: true,
		classifications: [{
			name: '工程学',
			onHover: false,
			subClasses: [{
				id: '',
				name: '课程一'
			}, {
				id: '',
				name: '课程二'
			}, {
				id: '',
				name: '课程三'
			}, {
				id: '',
				name: '课程四'
			}]
		}, {
			name: '商科',
			onHover: false,
			subClasses: [{
				id: '',
				name: '课程一'
			}, {
				id: '',
				name: '课程二'
			}, {
				id: '',
				name: '课程三'
			}, {
				id: '',
				name: '课程四'
			}]		
		}, {
			name: '法学',
			onHover: false,
			subClasses: [{
				id: '',
				name: '课程一'
			}, {
				id: '',
				name: '课程二'
			}, {
				id: '',
				name: '课程三'
			}]		
		}, {
			name: '计算机',
			onHover: false,
			subClasses: [{
				id: '',
				name: '课程一'
			}, {
				id: '',
				name: '课程二'
			}, {
				id: '',
				name: '课程三'
			}, {
				id: '',
				name: '课程四'
			}, {
				id: '',
				name: '课程五'
			}, {
				id: '',
				name: '课程六'
			}]		
		}],
		allSubjects: [{
			name: '工程学',
			allItems: ['item', 'item', 'item', 'item']
		}, {
			name: '商科',
			allItems: ['item', 'item', 'item', 'item', 'item', 'item', 'item', 'item', 'item', 'item', 'item', 'item', 'item', 'item', 'item', 'item', 'item']
		}, {
			name: '法学',
			allItems: ['item', 'item', 'item', 'item', 'item', 'item', 'item']
		}, {
			name: '计算机',
			allItems: ['item', 'item', 'item', 'item', 'item', 'item', 'item']
		}],
		hotNotes: [{
			title: 'GDP的组成部分',
			abstract: '消费（consumption）是家庭除购买新住房之外用于物品（goods）和劳务（services）的支出。“物品”包括家庭购买的汽车与家电等耐用品（durable goods），以及食品和衣服等非耐用品（nondurable goods）。',
			tags: ['GDP', '经济', '资本'],
			author: {
				name: 'Jack',
				school: '哥伦比亚大学',
				major: '经济学',
				followed: false
			},
			isFavorite: false
		}, {
			title: '国际关系理论 （international relation theories）',
			abstract: '消费（consumption）是家庭除购买新住房之外用于物品（goods）和劳务（services）的支出。“物品”包括家庭购买的汽车与家电等耐用品（durable goods），以及食品和衣服等非耐用品（nondurable goods）。',
			tags: ['资本', '权利'],
			author: {
				name: 'Aaron',
				school: '新加坡南洋理工大学',
				major: '国际关系学',
				followed: false
			},
			isFavorite: false
		}, {
			title: '国际货币基金组织（International Monetary Fund）',
			abstract: '消费（consumption）是家庭除购买新住房之外用于物品（goods）和劳务（services）的支出。“物品”包括家庭购买的汽车与家电等耐用品（durable goods），以及食品和衣服等非耐用品（nondurable goods）。',
			tags: ['货币'],
			author: {
				name: 'Mary',
				school: '华威大学',
				major: '国际政治经济学',
				followed: false
			},
			isFavorite: false
		}],
		hotMentors: [{
			name: 'Jack',
			school: '哥伦比亚大学',
			followed: false
		}, {
			name: 'Mary',
			school: '哈佛大学',
			followed: false
		}, {
			name: 'Jerry',
			school: '浙江大学',
			followed: false
		}, {
			name: 'Brian',
			school: '澳大利亚国立大学',
			followed: false
		}, {
			name: 'Nick',
			school: '清华大学',
			followed: false
		}, {
			name: 'Mike',
			school: '耶鲁大学',
			followed: false
		}],
		relatedNotes: [{
			title: 'GDP的组成部分',
			favoriteCount: 245,
			publishTime: 1,
			author: {
				name: 'Larry'
			}
		}, {
			title: '现实主义的主要观点',
			favoriteCount: 335,
			publishTime: 1,
			author: {
				name: 'Micky'
			}
		}, {
			title: '国际经济法和国际经济秩序',
			favoriteCount: 455,
			publishTime: 1,
			author: {
				name: 'Veronica'
			}
		}, {
			title: '国际金融法概述',
			favoriteCount: 1566,
			publishTime: 1,
			author: {
				name: 'Frida'
			}
		}, {
			title: '国际货币基金组织',
			favoriteCount: 234,
			publishTime: 1,
			author: {
				name: 'Candy'
			}
		}, {
			title: '国际货币基金组织',
			favoriteCount: 245,
			publishTime: 1,
			author: {
				name: 'Candy'
			}
		}]
	};
	return that;
}

xxModule.factory('noteService', noteService);
'use strict';
function userInfoController($scope, userInfoService) {
	var vm = this;
	vm.model = userInfoService.model;
	vm.getArray = function (count) {
		return new Array(count);
	};
	// refresh the date when year/month changed
	vm.birthChanged = function () {
		var changedBirth = vm.model.editingUser.birth;
		changedBirth.day = '1';
		changedBirth.dayInMonth = new Array(new Date(changedBirth.year, changedBirth.month, 0).getDate());
	};
}

xxModule.controller('userInfoController', ['$scope', 'userInfoService', userInfoController]);
'use strict';
function userInfoService() {
	var that = {};
	that.model = {
		editingUser: {
			name: 'Jack',
			school: '哈佛大学',
			major: '经济学',
			gender: 0,
			birth: {
				year: '1980',
				month: '1',
				day: '1',
				dayInMonth: new Array(31)
			}
		}
	};

	return that;
}

xxModule.factory('userInfoService', userInfoService);